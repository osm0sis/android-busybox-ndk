From 4fe833634cc56aae7e66858634335d52a9ec36b4 Mon Sep 17 00:00:00 2001
From: ukanth <cumakt@gmail.com>
Date: Fri, 3 Mar 2017 07:32:22 +0530
Subject: [PATCH] No need to exclude 017* and 025* and disable ipcrm/ipcs +
 syslogd/logread accordingly for x86 or mips builds

Signed-off-by: Umakanthan Chandran <cumakt@gmail.com>
---
 patches/017-g-missing_syscalls-semctl.patch | 65 +++++++++++++++++++++++++++++
 1 file changed, 65 insertions(+)
 create mode 100644 patches/017-g-missing_syscalls-semctl.patch

diff --git a/patches/017-g-missing_syscalls-semctl.patch b/patches/017-g-missing_syscalls-semctl.patch
new file mode 100644
index 0000000..b225e6e
--- /dev/null
+++ b/patches/017-g-missing_syscalls-semctl.patch
@@ -0,0 +1,65 @@
+--- a/libbb/missing_syscalls.c	2016-09-27 22:23:50.000000000 +0530
++++ b/libbb/missing_syscalls.c	2017-03-01 21:20:34.367667904 +0530
+@@ -10,6 +10,50 @@
+ #include <sys/syscall.h>
+ #include "libbb.h"
+ 
++#ifndef __NR_shmget
++#define __NR_shmget 29
++#endif
++
++#ifndef __NR_shmat
++#define __NR_shmat 30
++#endif
++
++#ifndef __NR_shmctl
++#define __NR_shmctl 31
++#endif
++
++#ifndef __NR_semget
++#define __NR_semget 64
++#endif
++
++#ifndef __NR_semop
++#define __NR_semop 65
++#endif
++
++#ifndef __NR_semctl
++#define __NR_semctl 66
++#endif
++
++#ifndef __NR_shmdt
++#define __NR_shmdt 67
++#endif
++
++#ifndef __NR_msgget
++#define __NR_msgget 68
++#endif
++
++#ifndef __NR_msgsnd
++#define __NR_msgsnd 69
++#endif
++
++#ifndef __NR_msgrcv
++#define __NR_msgrcv 70
++#endif
++
++#ifndef __NR_msgctl
++#define __NR_msgctl 71
++#endif
++ 
+ #if defined(ANDROID) || defined(__ANDROID__)
+ pid_t getsid(pid_t pid)
+ {
+--- a/libbb/semctl.c	2017-03-01 21:13:12.851652181 +0530
++++ b/libbb/semctl.c	2017-02-28 08:35:47.947890893 +0530
+@@ -27,6 +27,9 @@
+ #include <linux/sem.h>
+ #include "libbb.h"
+ 
++#ifndef __NR_semctl
++#define __NR_semctl 66
++#endif
+ /* code from GLIBC */
+ int semctl(int semid, int semnum, int cmd, ...) {
+   union semun arg;
-- 
1.9.1

